{"version":3,"file":"408.bundle.js","mappings":"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","sources":["webpack://martime-web-app/./src/gameController.js","webpack://martime-web-app/./src/utils/randomizers.js","webpack://martime-web-app/./src/lookout/3dmodv2.js"],"sourcesContent":["import * as TSSHandler from './utils/tss-handler.js';\nimport * as NCHandler from './utils/nc-handler.js';\nimport * as Draw from './radar/drawPaperElements.js';\nimport * as Calculate from './utils/calculators.js';\nimport * as Convert from './utils/converters.js';\n\nexport function updateShips(delta, params, shipsAfloat, TSS, NC) {\n  const deltaSecs = delta / 1000;\n  if (params.play == true) {\n    Draw.radarRings(project, params.centX, params.centY, params.onemile);\n    // Update TSS\n    if (TSS) {\n      const OSvecInSec = shipsAfloat[0].vector.length * 60;\n      const factor = deltaSecs / OSvecInSec;\n      let moveVector = shipsAfloat[0].vector.multiply(factor);\n      moveVector.angle = shipsAfloat[0].vector.angle - 180;\n      const newPosition = TSS.trafficLanes.occupied.position.add(moveVector);\n      TSSHandler.updatePositionOccupied(newPosition, TSS);\n      Draw.TSS(TSS);\n    }\n    // Update Narrow Channel\n    if (NC) {\n      const OSvecInSec = shipsAfloat[0].vector.length * 60;\n      const factor = deltaSecs / OSvecInSec;\n      let moveVector = shipsAfloat[0].vector.multiply(factor);\n      moveVector.angle = shipsAfloat[0].vector.angle - 180;\n      const newPosition = NC.lanes.occupied.position.add(moveVector);\n      NCHandler.updatePositionOccupied(newPosition, NC);\n      NC.markers.relPositionsPort = NCHandler.updateMarkerRelPositions(\n        NC.markers.portMarkers,\n        shipsAfloat[0].position,\n        params.onemile\n      );\n      NC.markers.relPositionsStarboard = NCHandler.updateMarkerRelPositions(\n        NC.markers.starboardMarkers,\n        shipsAfloat[0].position,\n        params.onemile\n      );\n      Draw.narrowChannel(NC, params.onemile, params.centX, params.centY);\n    }\n    Draw.ship(shipsAfloat[0], params.shipVctrLngth, params.onemile);\n    for (var i = 0; i < shipsAfloat.length; i++) {\n      var ship = shipsAfloat[i];\n      if (ship.type != 'Own Ship') {\n        // ship.relVec describes the velocity over ShipVctrLength (time)\n        // Find the fractions of event.delta/params.shipVctrLngth and reduce the rel vec by this factor.\n        // params.shipVctrLngth in secs\n        let SvecInSec = params.shipVctrLngth * 60;\n        let factor = deltaSecs / SvecInSec;\n        let moveVector = ship.relVec.multiply(factor);\n        ship.position = ship.position.add(moveVector);\n        ship.vecEnd = ship.vecEnd.add(moveVector);\n        // Update rel position\n        ship.vecOwnShip = ship.position.subtract(shipsAfloat[0].position);\n        ship.OwnShipAngle = ship.vecOwnShip.angle;\n        ship.relposXnm = Convert.pixelsToMiles(\n          ship.vecOwnShip.x,\n          params.onemile\n        );\n        ship.relposYnm = Convert.pixelsToMiles(\n          ship.vecOwnShip.y,\n          params.onemile\n        );\n        // Update USNRel\n        ship.USNRel = updateUSNR(ship, shipsAfloat[0]);\n        ship.USNRelFrmOwnShp = updateUSNRFrmOwnshp(ship, shipsAfloat[0]);\n        Calculate.CPA(\n          ship,\n          shipsAfloat[0],\n          params.shipVctrLngth,\n          params.onemile\n        );\n        if ($('#radar').is(':visible'))\n          Draw.ship(ship, params.shipVctrLngth, params.onemile);\n      }\n    }\n  }\n}\n\nfunction updateUSNR(ship, ownship) {\n  const vecOwnShip = ship.position.subtract(ownship.position);\n  return Calculate.USNRel(\n    Convert.vecAngleToCompassBrng(vecOwnShip.angle),\n    Convert.vecAngleToCompassBrng(ship.vector.angle)\n  );\n}\n\nfunction updateUSNRFrmOwnshp(ship, ownship) {\n  const vecOwnShip = ownship.position.subtract(ship.position);\n  return Calculate.USNRel(\n    Convert.vecAngleToCompassBrng(vecOwnShip.angle),\n    Convert.vecAngleToCompassBrng(ownship.vector.angle)\n  );\n}\n","// Functions for picking random numbers\nexport function IntFromInterval(min, max) {\n  // min and max included\n  return Math.random() * (max - 1 - min + 1) + min;\n}\n","// Imports\nimport * as THREE from 'three';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass.js';\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer.js';\nimport { UnrealBloomPass } from 'three/examples/jsm/postprocessing/UnrealBloomPass.js';\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass.js';\nimport { Water } from 'three/examples/jsm/objects/Water.js';\nimport { Sky } from 'three/examples/jsm/objects/Sky.js';\nimport * as Convert from '../utils/converters.js';\nimport { TSS, NC, params, shipsAfloat } from '../app.js';\nimport * as gameController from '../gameController.js';\nimport * as Ran from '../utils/randomizers.js';\n\n// Declare variables\nlet camera, scene, renderer;\nlet water, sun;\nlet bloomPass, bloomComposer, finalComposer, finalPass;\nconst parameters = {\n  sunriseElevation: 2,\n  sunsetElevation: 178,\n  elevation: null,\n  azimuth: 90,\n};\nconst fps = 30;\nlet now;\nlet then = Date.now();\nconst interval = 1000 / fps;\nlet delta;\nlet buoys = new THREE.Group();\nbuoys.name = 'buoys';\nlet dark;\nconst buoyFlashInterval = 1000; // Milliseconds\nconst buoyFlashLength = 1000; // Milliseconds\n\n// Declare variable for controls\nlet zoomed = false;\nlet turnRate = 0;\n\n// Create variable for selective bloom process\nconst darkMaterial = new THREE.MeshBasicMaterial({ color: 'black' });\nconst materials = {};\n\n// Create scene\nscene = new THREE.Scene();\n\n// Camera\ncamera = new THREE.PerspectiveCamera(\n  55,\n  window.innerWidth / window.innerHeight,\n  1,\n  20000\n);\ncamera.position.set(30, 30, 100);\n\n// audio\n\nconst audioLoader = new THREE.AudioLoader();\nconst listener = new THREE.AudioListener();\ncamera.add(listener);\n\n// Setup elevation from environment variable\nswitch (params.environment) {\n  case 'day':\n    parameters.elevation = Ran.IntFromInterval(\n      parameters.sunriseElevation,\n      parameters.sunsetElevation\n    );\n    console.log(parameters.elevation);\n    dark = false;\n    break;\n  case 'night':\n    parameters.elevation = Ran.IntFromInterval(\n      parameters.sunriseElevation,\n      -parameters.sunsetElevation\n    );\n    console.log(parameters.elevation);\n    dark = true;\n    break;\n}\n\n//Make each loader a promise\nvar loader = new GLTFLoader();\n\n// Create object with types of vessels and paths to audio\n\nconst fogSignals = {\n  PDV: 'assets/pdv-fog-signal.mp3',\n  SV: 'assets/lame-duck-fog-signal.mp3',\n  VEIF: 'assets/lame-duck-fog-signal.mp3',\n  NUC: 'assets/lame-duck-fog-signal.mp3',\n  RAM: 'assets/lame-duck-fog-signal.mp3',\n  anchorless100m: 'assets/at-anchor-less-than-100m.mp3',\n};\n\nconst loaderProm = (modelPath, relposXnm, relposYnm, course, name, type) => {\n  return new Promise((resolve, reject) => {\n    loader.load(\n      modelPath,\n      function (gltf) {\n        let model = gltf.scene;\n        model.position.set(convertPos(relposXnm), 0, convertPos(relposYnm));\n        // Three JS rotates anti-clockwise, subtract angles from Paper JS\n        model.rotation.y = -course;\n        model.name = name;\n        if (params.environment === 'resVis') {\n          // Add audio\n          audioLoader.load(getAudioPath(type), function (buffer) {\n            const audio = new THREE.PositionalAudio(listener);\n            audio.setBuffer(buffer);\n            audio.setRefDistance(10);\n            audio.setLoop(true);\n            if (type == 'PDV') {\n              audio.offset = Math.random();\n            }\n            model.add(audio);\n            scene.add(model);\n          });\n        } else scene.add(model);\n\n        resolve('success');\n      },\n      undefined,\n      function (err) {\n        reject(err);\n      }\n    );\n  });\n};\n\nconst buoyLoaderProm = (modelPath, relposXnm, relposYnm, name, number) => {\n  return new Promise((resolve, reject) => {\n    loader.load(\n      modelPath,\n      function (gltf) {\n        let model = gltf.scene;\n        model.position.set(convertPos(relposXnm), 0, convertPos(relposYnm));\n        model.name = name;\n        model.number = number;\n        model.flashInterval = buoyFlashInterval;\n        model.flashLength = buoyFlashLength;\n        model.lightOn = true;\n        buoys.add(model);\n        resolve('success');\n      },\n      undefined,\n      function (err) {\n        reject(err);\n      }\n    );\n  });\n};\n\nfunction buildThreeDRendering() {\n  //Rotate camera to own ships head\n  // - pi/2 as the orientation for Paper JS is 90 degrees different.\n  camera.rotation.y = -shipsAfloat[0].course - Math.PI / 2;\n  $('#base-wrapper').css(\n    'transform',\n    'rotate(' +\n      Math.round((shipsAfloat[0].course * 180) / Math.PI + 90) +\n      'deg)'\n  );\n\n  // Start async loading models as soon as page loads\n  const totalLoader = new Promise((resolve, reject) => {\n    (async () => {\n      try {\n        const proms = [];\n        //Loop through shipsAfloat and create a promise for each model loader\n        shipsAfloat.slice(1).forEach((ship) => {\n          proms.push(\n            loaderProm(\n              'assets/' + ship.type + '.glb',\n              ship.relposXnm,\n              ship.relposYnm,\n              ship.course,\n              ship.name,\n              ship.type\n            )\n          );\n        });\n        // Add buoys for narrow channels\n        if (NC) {\n          NC.markers.relPositionsPort.forEach((marker, i) => {\n            proms.push(\n              buoyLoaderProm(\n                'assets/portMarker.glb',\n                marker.x,\n                marker.y,\n                `port_marker_${i}`,\n                i\n              )\n            );\n          });\n          NC.markers.relPositionsStarboard.forEach((marker, i) => {\n            proms.push(\n              buoyLoaderProm(\n                'assets/stbMarker.glb',\n                marker.x,\n                marker.y,\n                `starboard_marker_${i}`,\n                i\n              )\n            );\n          });\n        }\n        const all = await Promise.all(proms);\n        if (NC) scene.add(buoys);\n        resolve(all);\n      } catch (err) {\n        reject(err);\n      }\n    })();\n  });\n\n  // Intiate other elements\n  const init = new Promise((resolve, reject) => {\n    renderer = new THREE.WebGLRenderer({\n      canvas: ThreeDcanvas,\n    });\n    renderer.setPixelRatio(window.devicePixelRatio);\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    renderer.toneMapping = THREE.ACESFilmicToneMapping;\n\n    //\n\n    scene = new THREE.Scene();\n    const renderScene = new RenderPass(scene, camera);\n\n    //\n\n    sun = new THREE.Vector3();\n\n    // Water\n\n    const waterGeometry = new THREE.PlaneGeometry(100000, 100000);\n\n    water = new Water(waterGeometry, {\n      textureWidth: 512,\n      textureHeight: 512,\n      waterNormals: new THREE.TextureLoader().load(\n        'assets/waternormals.jpg',\n        function (texture) {\n          texture.wrapS = texture.wrapT = THREE.RepeatWrapping;\n        }\n      ),\n      sunDirection: new THREE.Vector3(),\n      sunColor: 0xffffff,\n      waterColor: 0x001e0f,\n      distortionScale: 3.7,\n      fog: scene.fog !== undefined,\n    });\n\n    water.rotation.x = -Math.PI / 2;\n\n    scene.add(water);\n\n    // Skybox\n\n    const sky = new Sky();\n    sky.scale.setScalar(10000);\n    scene.add(sky);\n\n    const skyUniforms = sky.material.uniforms;\n\n    skyUniforms['turbidity'].value = 10;\n    skyUniforms['rayleigh'].value = 2;\n    skyUniforms['mieCoefficient'].value = 0.005;\n    skyUniforms['mieDirectionalG'].value = 0.8;\n\n    const pmremGenerator = new THREE.PMREMGenerator(renderer);\n    let renderTarget;\n\n    //Fog\n    if (params.environment === 'resVis') {\n      skyUniforms['mieCoefficient'].value = 0.8;\n      skyUniforms['mieDirectionalG'].value = 0.5;\n      scene.fog = new THREE.Fog(0x484849, 1000, 1100);\n      parameters.elevation = 55.23;\n    }\n\n    function updateSun() {\n      const phi = THREE.MathUtils.degToRad(90 - parameters.elevation);\n      const theta = THREE.MathUtils.degToRad(parameters.azimuth);\n\n      sun.setFromSphericalCoords(1, phi, theta);\n\n      sky.material.uniforms['sunPosition'].value.copy(sun);\n      water.material.uniforms['sunDirection'].value.copy(sun).normalize();\n      water.material.blendDst = 2;\n\n      if (renderTarget !== undefined) renderTarget.dispose();\n\n      renderTarget = pmremGenerator.fromScene(sky);\n\n      scene.environment = renderTarget.texture;\n    }\n\n    updateSun();\n\n    // Bloom\n    bloomPass = new UnrealBloomPass(\n      new THREE.Vector2(window.innerWidth, window.innerHeight),\n      1.5,\n      0.4,\n      0.85\n    );\n    bloomPass.threshold = 0;\n    bloomPass.strength = 5;\n    bloomPass.radius = 1;\n\n    bloomComposer = new EffectComposer(renderer);\n    bloomComposer.renderToScreen = false;\n    bloomComposer.addPass(renderScene);\n    bloomComposer.addPass(bloomPass);\n\n    finalPass = new ShaderPass(\n      new THREE.ShaderMaterial({\n        uniforms: {\n          baseTexture: { value: null },\n          bloomTexture: { value: bloomComposer.renderTarget2.texture },\n        },\n        vertexShader: document.getElementById('vertexshader').textContent,\n        fragmentShader: document.getElementById('fragmentshader').textContent,\n        defines: {},\n      }),\n      'baseTexture'\n    );\n\n    finalPass.needsSwap = true;\n\n    finalComposer = new EffectComposer(renderer);\n    finalComposer.addPass(renderScene);\n    finalComposer.addPass(finalPass);\n\n    //Make Canvas responsive\n    window.addEventListener('resize', () => {\n      renderer.setSize(window.innerWidth, window.innerHeight);\n      camera.aspect = window.innerWidth / window.innerHeight;\n      camera.updateProjectionMatrix();\n      bloomComposer.setSize(window.innerWidth, window.innerHeight);\n      finalComposer.setSize(window.innerWidth, window.innerHeight);\n    });\n    window.addEventListener('orientationchange', () => {\n      renderer.setSize(window.innerWidth, window.innerHeight);\n      camera.aspect = window.innerWidth / window.innerHeight;\n      camera.updateProjectionMatrix();\n      bloomComposer.setSize(window.innerWidth, window.innerHeight);\n      finalComposer.setSize(window.innerWidth, window.innerHeight);\n    });\n\n    // Instrument display\n\n    $('#course-display').append(\n      `<p>${Convert.brngToFourFigStrng(\n        Convert.vecAngleToCompassBrng(shipsAfloat[0].vector.angle).toFixed(1)\n      )}&deg;</p>`\n    );\n    $('#speed-display').append(`<p>${shipsAfloat[0].speed.toFixed(1)} Kts</p>`);\n\n    resolve('success');\n    reject('Error during intialization');\n    console.log(scene);\n  });\n\n  //Await init and animate to complete before animating\n\n  (async () => {\n    try {\n      await Promise.all([totalLoader, init]);\n\n      shipLightControl(dark);\n\n      animate();\n      $('.threeOverlay').hide();\n    } catch (err) {\n      console.log(err);\n    }\n  })();\n}\n\nfunction animate() {\n  requestAnimationFrame(animate);\n  if (params.play === true) {\n    now = Date.now();\n    delta = now - then;\n\n    if (delta > interval) {\n      // update time variables\n      then = now - (delta % interval);\n\n      // update positions\n      // Update ships\n      gameController.updateShips(interval, params, shipsAfloat, TSS, NC);\n      // Only call if three canvas is visible\n      if ($('#lookOut').is(':visible')) {\n        if (dark) renderBloom();\n        render();\n        control();\n        showBrng();\n        // Animate ships movement\n        // Ship models can be found in scene.children\n        for (let i = 2; i < scene.children.length; i++) {\n          if (scene.children[i].name.startsWith('00')) {\n            let shipName = scene.children[i].name;\n            // Find the index number for ship with the same name from the shipsAfloat array\n            // Defined in nameToIndex function\n            let indexNo = nameToIndex(shipName);\n            scene.children[i].position.set(\n              convertPos(shipsAfloat[indexNo].relposXnm),\n              0,\n              convertPos(shipsAfloat[indexNo].relposYnm)\n            );\n\n            // If dark control directional lights\n            if (dark) {\n              dLights(indexNo, scene.children[i]);\n            }\n            overHorizon(indexNo, scene.children[i]); // If ship over 11nm away make invisible\n            //Audio\n            if ((shipName = '003')) {\n              // Get audio element (last element in the model)\n              const audio =\n                scene.children[i].children[\n                  scene.children[i].children.length - 1\n                ];\n              if (audio.isPlaying == false) {\n                audio.play();\n              }\n            }\n          }\n          // Animate buoys\n          if (NC && scene.children[i].name == 'buoys') {\n            for (let j = 0; j < scene.children[i].children.length; j++) {\n              const MarkerNumber = scene.children[i].children[j].number;\n              if (scene.children[i].children[j].name.startsWith('port')) {\n                const range = Math.sqrt(\n                  Math.pow(NC.markers.relPositionsPort[MarkerNumber].x, 2) +\n                    Math.pow(NC.markers.relPositionsPort[MarkerNumber].y, 2)\n                );\n                if (range > 11) scene.children[i].children[j].visible = false;\n                else {\n                  scene.children[i].children[j].visible = true;\n                  scene.children[i].children[j].position.set(\n                    convertPos(NC.markers.relPositionsPort[MarkerNumber].x),\n                    0,\n                    convertPos(NC.markers.relPositionsPort[MarkerNumber].y)\n                  );\n                }\n              } else if (\n                scene.children[i].children[j].name.startsWith('starboard')\n              ) {\n                const range = Math.sqrt(\n                  Math.pow(\n                    NC.markers.relPositionsStarboard[MarkerNumber].x,\n                    2\n                  ) +\n                    Math.pow(\n                      NC.markers.relPositionsStarboard[MarkerNumber].y,\n                      2\n                    )\n                );\n                // Make invisible if over 11nm\n                if (range > 11) scene.children[i].children[j].visible = false;\n                else {\n                  scene.children[i].children[j].visible = true;\n                  scene.children[i].children[j].position.set(\n                    convertPos(\n                      NC.markers.relPositionsStarboard[MarkerNumber].x\n                    ),\n                    0,\n                    convertPos(NC.markers.relPositionsStarboard[MarkerNumber].y)\n                  );\n                }\n              }\n              // Animate Flashing light\n              if (scene.children[i].children[j].visible == true && dark)\n                flashLight(scene.children[i].children[j]);\n            }\n          }\n        }\n      }\n    }\n  }\n}\n// Other functions\n\n// If ship over 11nm away make invisible\nfunction overHorizon(indexNo, shipObject) {\n  if (shipsAfloat[indexNo].range > 11) shipObject.visible = false;\n  else shipObject.visible = true;\n}\n\n// Turn directional lights on/off;\nfunction dLights(indexNo, shipObject) {\n  const shipUSN = shipsAfloat[indexNo].USNRel;\n  shipObject.traverse((el) => {\n    // Starboard side light\n    if (\n      el.name.includes('SG') &&\n      ((shipUSN > 0 && shipUSN < 112.5) || (shipUSN > 354 && shipUSN < 360))\n    )\n      el.visible = true;\n    if (el.name.includes('SG') && shipUSN > 112.5 && shipUSN < 354)\n      el.visible = false;\n    // Port side light\n    if (\n      el.name.includes('SR') &&\n      ((shipUSN > 247.5 && shipUSN < 360) || (shipUSN > 0 && shipUSN < 4))\n    )\n      el.visible = true;\n    if (el.name.includes('SR') && shipUSN > 4 && shipUSN < 247.5)\n      el.visible = false;\n    // Mast Head light\n    if (\n      el.name.includes('MH') &&\n      ((shipUSN > 247.5 && shipUSN < 360) || (shipUSN > 0 && shipUSN < 112.5))\n    )\n      el.visible = true;\n    if (el.name.includes('MH') && shipUSN > 112.5 && shipUSN < 247.5)\n      el.visible = false;\n    // Stern light\n    if (el.name.includes('STRN') && shipUSN > 112.5 && shipUSN < 247.5)\n      el.visible = true;\n    if (el.name.includes('STRN') && shipUSN > 0 && shipUSN < 112.5)\n      el.visible = false;\n    if (el.name.includes('STRN') && shipUSN > 247.5 && shipUSN < 360)\n      el.visible = false;\n  });\n}\n\n// ShipsAfloat and Scene do not have the ships in the same order. Therefore match name to index.\nfunction nameToIndex(shipName) {\n  return shipsAfloat.findIndex(function checkName(array) {\n    return array.name == shipName;\n  });\n}\n// Ship Lights functions\n\nfunction shipLightControl(dark) {\n  // All lights are visible by default\n  // Turn off all lights if dark is false\n  if (!dark) {\n    scene.traverse((obj) => {\n      if (obj.name.includes('light')) {\n        obj.visible = false;\n      }\n    });\n  }\n}\n\nfunction startFlashing(buoy) {\n  const randomTimeDelta = Math.random() * buoyFlashLength;\n  buoy.lastSwitch = Date.now() - randomTimeDelta;\n}\n\nfunction flashLight(buoy) {\n  if (!buoy.lastSwitch) startFlashing(buoy); // Start flashing sequence at different times\n  const timeSinceSwitch = Date.now() - buoy.lastSwitch;\n  // If light is on and time since last switch is greater than flash length turn it off\n  if (buoy.lightOn && timeSinceSwitch > buoy.flashLength) {\n    buoy.traverse((obj) => {\n      if (obj.name.includes('light')) {\n        obj.visible = false;\n      }\n      buoy.lightOn = false;\n      buoy.lastSwitch = Date.now();\n    });\n    // If light is off and time since last switch is greater than flash interval length turn it on\n  } else if (!buoy.lightOn && timeSinceSwitch > buoy.flashInterval) {\n    buoy.traverse((obj) => {\n      if (obj.name.includes('light')) {\n        obj.visible = true;\n      }\n      buoy.lightOn = true;\n      buoy.lastSwitch = Date.now();\n    });\n  }\n}\n\nfunction control() {\n  //Zoomed variable\n  if (!zoomed) {\n    camera.fov = 45;\n    camera.updateProjectionMatrix();\n  } else {\n    camera.fov = 20;\n    camera.updateProjectionMatrix();\n  }\n\n  camera.rotation.y += turnRate;\n}\n\n//Bearing Display\nlet currentBearing = '';\n\nfunction showBrng() {\n  let vector = new THREE.Vector3();\n  camera.getWorldDirection(vector);\n  // Add Pi/2 to get back to north up orientation.\n  let radians = Math.atan2(vector.z, vector.x) + Math.PI / 2;\n  // Convert to bearing for bearing logger\n  if (radians < 0) radians += 2 * Math.PI;\n  currentBearing = Math.round((radians * 180) / Math.PI);\n  // Create an array of bearings 1 degree apart\n  let bearings = [\n    radians - 0.035,\n    radians - 0.0175,\n    radians,\n    radians + 0.0175,\n    radians + 0.035,\n  ];\n  // Convert all radians to degrees add 00s and convert to strings\n  bearings.forEach(function (bearing, index) {\n    // Add 90 degrees\n    if (bearing < 0) bearing += 2 * Math.PI;\n    let rounded = Math.round((bearing * 180) / Math.PI);\n    bearings[index] = Convert.brngToFourFigStrng(rounded);\n  });\n  $('#orientator').css('transform', 'rotate(' + bearings[2] + 'deg)');\n  $('#vis-bearing').text('');\n  bearings[2] = '<span id=fcsBrng>' + bearings[2] + '</span>';\n  $('#vis-bearing').append(bearings.join('  '));\n}\n\n//Scale 12NM = 12000M\nfunction convertPos(pos) {\n  var b = pos * 1000;\n  return b;\n}\n\nfunction render() {\n  const time = performance.now() * 0.001;\n  if (water.material.uniforms) {\n    water.material.uniforms['time'].value += 1.0 / 60.0;\n  }\n\n  renderer.render(scene, camera);\n  // render scene with bloom\n  renderBloom(true);\n  // render the entire scene, then render bloom scene on top\n  finalComposer.render();\n}\n\n// Blacking out scene and then restoring\nfunction renderBloom(mask) {\n  scene.traverse(darkenNonBloomed);\n  bloomComposer.render();\n  scene.traverse(restoreMaterial);\n}\n\nfunction darkenNonBloomed(obj) {\n  if (obj.isMesh && !obj.name.includes('light')) {\n    materials[obj.uuid] = obj.material;\n    obj.material = darkMaterial;\n  }\n}\n\nfunction restoreMaterial(obj) {\n  if (materials[obj.uuid]) {\n    obj.material = materials[obj.uuid];\n    delete materials[obj.uuid];\n  }\n}\n\nconst getAudioPath = function (type) {\n  return fogSignals[type];\n};\n\nconst playAudio = function () {\n  console.log('Fired play audio');\n  scene.traverse((obj) => {\n    if (obj.type == 'Audio') {\n      console.log(obj);\n      obj.context.resume();\n    }\n  });\n};\n// On document ready\n$(function () {\n  // Change view\n  $('#zoom-view').on('touchstart mousedown', function () {\n    zoomed = true;\n    $('#zoom-view').addClass('view-selected');\n    $('#eye-view').removeClass('view-selected');\n    $('#compass-view').removeClass('view-selected');\n    if ($('#compass-cont').is(':visible')) $('#compass-cont').toggle();\n    if ($('#instrument-panel').is(':visible'));\n    else $('#instrument-panel').toggle();\n    $('#left-arrow i')\n      .addClass('fa-duotone fa-chevrons-left')\n      .removeClass('fa-regular fa-chevron-left');\n    $('#right-arrow i')\n      .addClass('fa-duotone fa-chevrons-right')\n      .removeClass('fa-regular fa-chevron-right');\n  });\n\n  $('#eye-view').on('touchstart mousedown', function () {\n    zoomed = false;\n    $('#eye-view').addClass('view-selected');\n    $('#zoom-view').removeClass('view-selected');\n    $('#compass-view').removeClass('view-selected');\n    if ($('#compass-cont').is(':visible')) $('#compass-cont').toggle();\n    if ($('#instrument-panel').is(':visible'));\n    else $('#instrument-panel').toggle();\n    // Change arrows\n    $('#left-arrow i')\n      .addClass('fa-duotone fa-chevrons-left')\n      .removeClass('fa-regular fa-chevron-left');\n    $('#right-arrow i')\n      .addClass('fa-duotone fa-chevrons-right')\n      .removeClass('fa-regular fa-chevron-right');\n  });\n\n  $('#compass-view').on('touchstart mousedown', function () {\n    zoomed = false;\n    $('#eye-view').removeClass('view-selected');\n    $('#zoom-view').removeClass('view-selected');\n    $('#compass-view').addClass('view-selected');\n    if ($('#compass-cont').is(':visible'));\n    else $('#compass-cont').toggle();\n    if ($('#instrument-panel').is(':visible')) $('#instrument-panel').toggle();\n    bearingLogger(true);\n    // Change arrows\n    $('#left-arrow i')\n      .addClass('fa-regular fa-chevron-left')\n      .removeClass('fa-duotone fa-chevrons-left');\n    $('#right-arrow i')\n      .addClass('fa-regular fa-chevron-right')\n      .removeClass('fa-duotone fa-chevrons-right');\n  });\n\n  // Camera Controls\n\n  // Controls\n  $('#left-arrow').on(\n    'hover',\n    function (e) {\n      $(this).css('color', 'rgba(255, 255, 255, 1)');\n    },\n    function () {\n      $(this).css('color', 'rgba(255, 255, 255, 0.75)');\n    }\n  );\n\n  $('#left-arrow').on('touchstart mousedown', function (e) {\n    e.preventDefault();\n    if ($('#compass-cont').is(':visible')) {\n      turnRate = 0.0009;\n      bearingLogger();\n    } else turnRate = 0.01;\n    $(this).css('color', 'rgba(255, 255, 255, 1)');\n  });\n\n  $('#left-arrow').on('touchend mouseup', function (e) {\n    e.preventDefault();\n    turnRate = 0;\n    $(this).css('color', 'rgba(255, 255, 255, 0.75)');\n  });\n  // Keys\n  $(document).on('keydown', function (e) {\n    if (e.which == 37) {\n      if ($('#compass-cont').is(':visible')) {\n        turnRate = 0.0009;\n        bearingLogger();\n      } else turnRate = 0.01;\n    }\n  });\n\n  $(document).on('keyup', function (e) {\n    if (e.which == 37) {\n      turnRate = 0;\n    }\n  });\n\n  $('#right-arrow').on(\n    'hover',\n    function (e) {\n      $(this).css('color', 'rgba(255, 255, 255, 1)');\n    },\n    function () {\n      $(this).css('color', 'rgba(255, 255, 255, 0.75)');\n    }\n  );\n\n  $('#right-arrow').on('touchstart mousedown', function (e) {\n    e.preventDefault();\n    if ($('#compass-cont').is(':visible')) {\n      turnRate = -0.0009;\n      bearingLogger();\n    } else turnRate = -0.01;\n    $(this).css('color', 'rgba(255, 255, 255, 1)');\n  });\n  $('#right-arrow').on('touchend mouseup', function (e) {\n    e.preventDefault();\n    turnRate = 0;\n    $(this).css('color', 'rgba(255, 255, 255, 0.75)');\n  });\n\n  //Keys\n  $(document).on('keydown', function (e) {\n    if (e.which == 39) {\n      if ($('#compass-cont').is(':visible')) {\n        turnRate = -0.0009;\n        bearingLogger();\n      } else turnRate = -0.01;\n    }\n  });\n\n  $(document).on('keyup', function (e) {\n    if (e.which == 39) {\n      turnRate = 0;\n    }\n  });\n  // Call for bearing logger and playAudio\n  $('#lookout-button').on('touchstart mousedown', function () {\n    bearingLogger(); // Check if bearing is being taken. This is to capture occasions when the compass is left displayed and view is changed from and then back to look out.\n    playAudio(); //\n  });\n});\n\n// Bearing Logger\nlet currentTime = '';\nconst bearingLogger = function (clickedCompass) {\n  // Only log when using compass\n  const timeAtLastClick = currentTime;\n  currentTime = Date.now();\n  // Time since last rotation click\n  const dwellTime = currentTime - timeAtLastClick;\n\n  // Check if bearing has been taken\n  shipsAfloat.slice(1).forEach((ship) => {\n    // Get absolute difference between currentBearing and ship bearing\n    const bearingDiff = Math.abs(\n      Convert.vecAngleToCompassBrng(Math.round(ship.vecOwnShip.angle)) -\n        currentBearing\n    );\n    if (dwellTime > 1000 && bearingDiff < 3) {\n      -console.log(\n        `bearingDiff = ${bearingDiff} | dwellTime = ${dwellTime} |  actualBearing = ${ship.bearing}`\n      );\n      ship.bearingsTaken.push(timeAtLastClick);\n    }\n    // Change to compass view already on the right bearing \"clickedCompass\"\n    // Ignore dwellTime\n    if (clickedCompass && bearingDiff < 4) {\n      ship.bearingsTaken.push(currentTime);\n    }\n  });\n};\nexport { buildThreeDRendering };\n"],"names":["updateUSNR","ship","ownship","vecOwnShip","position","subtract","angle","vector","updateUSNRFrmOwnshp","IntFromInterval","min","max","Math","random","camera","scene","renderer","water","sun","bloomPass","bloomComposer","finalComposer","finalPass","parameters","sunriseElevation","sunsetElevation","elevation","azimuth","now","then","Date","interval","delta","dark","buoys","name","buoyFlashLength","zoomed","turnRate","darkMaterial","color","materials","window","innerWidth","innerHeight","set","audioLoader","listener","add","console","log","loader","GLTFLoader","fogSignals","PDV","SV","VEIF","NUC","RAM","anchorless100m","loaderProm","modelPath","relposXnm","relposYnm","course","type","Promise","resolve","reject","load","gltf","model","convertPos","rotation","y","getAudioPath","buffer","audio","setBuffer","setRefDistance","setLoop","offset","undefined","err","buoyLoaderProm","number","flashInterval","flashLength","lightOn","buildThreeDRendering","PI","css","round","totalLoader","proms","forEach","push","NC","marker","i","x","all","init","canvas","ThreeDcanvas","setPixelRatio","devicePixelRatio","setSize","toneMapping","renderScene","RenderPass","waterGeometry","Water","textureWidth","textureHeight","waterNormals","texture","wrapS","wrapT","sunDirection","sunColor","waterColor","distortionScale","fog","sky","Sky","scale","setScalar","skyUniforms","material","uniforms","value","pmremGenerator","renderTarget","phi","theta","setFromSphericalCoords","copy","normalize","blendDst","dispose","fromScene","environment","updateSun","UnrealBloomPass","threshold","strength","radius","EffectComposer","renderToScreen","addPass","ShaderPass","baseTexture","bloomTexture","renderTarget2","vertexShader","document","getElementById","textContent","fragmentShader","defines","needsSwap","addEventListener","aspect","updateProjectionMatrix","append","toFixed","traverse","obj","includes","visible","shipLightControl","animate","hide","requestAnimationFrame","params","shipsAfloat","TSS","deltaSecs","play","project","centX","centY","onemile","factor","length","moveVector","multiply","newPosition","trafficLanes","occupied","lanes","markers","relPositionsPort","portMarkers","relPositionsStarboard","starboardMarkers","shipVctrLngth","relVec","vecEnd","OwnShipAngle","USNRel","USNRelFrmOwnShp","$","is","renderBloom","performance","render","fov","getWorldDirection","radians","atan2","z","currentBearing","bearings","bearing","index","rounded","text","join","showBrng","children","startsWith","shipName","indexNo","nameToIndex","dLights","overHorizon","isPlaying","j","MarkerNumber","sqrt","pow","flashLight","shipObject","range","shipUSN","el","array","buoy","lastSwitch","randomTimeDelta","startFlashing","timeSinceSwitch","pos","mask","darkenNonBloomed","restoreMaterial","isMesh","uuid","on","addClass","removeClass","toggle","bearingLogger","e","this","preventDefault","which","context","resume","currentTime","clickedCompass","timeAtLastClick","dwellTime","bearingDiff","abs","bearingsTaken"],"sourceRoot":""}